# Quiz Mode Feature Plan

**Status**: ðŸ“‹ PLANNED
**Goal**: Replace "Mark as Read" and "Confirm" buttons with a single "Quiz" button that adds flashcards, runs a quiz session, and shows a summary with score.

## Overview

Currently, users read topics and then separately confirm to add flashcards. This plan introduces a quiz mode that streamlines the learning flow: after reading, users take a quiz on that topic. The quiz adds flashcards for the topic, gives one chance per card, shows a summary with score, and allows progression or re-reading. This creates a more integrated read â†’ quiz â†’ progress workflow.

---

## Task 1: Update TopicReader UI - Replace Buttons

Replace the two buttons ("Mark as Read" and "Confirm & Add Flashcards") with a single "Quiz" button at the end of the reading view.

**Requirements**:
- Given user is viewing a topic, should show one "Quiz" button instead of two buttons
- Given user clicks Quiz button, should trigger quiz flow (adding cards if needed, then starting quiz)

**Files to modify**:
- `src/components/TopicReader.tsx` (lines 394-460)

---

## Task 2: Create Quiz Component

Create a new Quiz component that handles quiz sessions with single-chance-per-card mode.

**Requirements**:
- Given quiz session starts, should show cards from the specified topic
- Given user rates a card, should mark as answered and move to next card (no retries)
- Given all cards are answered, should show summary with score
- Given quiz is in progress, should track correct/incorrect answers for score calculation
- Given quiz session, should filter cards by topic ID

**Files to create**:
- `src/components/Quiz.tsx`

**Key features**:
- Filter cards by topic (using primary topic from card tags)
- One chance per card before moving to next
- Track quiz results (correct/incorrect)
- Calculate score as percentage
- Show summary when complete

---

## Task 3: Integrate Quiz Flow in TopicReader

Add state management and navigation to start quiz from TopicReader and handle return after quiz.

**Requirements**:
- Given user clicks Quiz button, should add flashcards for topic if not already added
- Given flashcards are added, should start quiz with topic cards
- Given quiz completes, should return to TopicReader with summary
- Given summary is shown, should allow navigation to next topic or re-read

**Files to modify**:
- `src/components/TopicReader.tsx`

**Key state**:
- Quiz mode state (not started, in progress, completed)
- Quiz results (score, cards answered)
- Navigation state (show summary, allow next/retry)

---

## Task 4: Create Quiz Summary Component

Create a component that displays quiz results with score, suggestion, and navigation options.

**Requirements**:
- Given quiz completes, should show score as percentage
- Given score is less than 80%, should suggest reading again (but still allow next topic)
- Given score is 80% or higher, should allow next topic without suggestion
- Given summary is shown, should provide "Next Topic" and "Read Again" buttons
- Given user clicks "Read Again", should return to reading view
- Given user clicks "Next Topic", should navigate to next topic

**Files to create**:
- `src/components/QuizSummary.tsx`

**Key features**:
- Display score prominently
- Conditional suggestion based on score threshold
- Navigation buttons (Next Topic, Read Again)

---

## Task 5: Filter Cards by Correctness on Re-quiz

When user reads topic again and clicks Quiz, only show cards that were answered incorrectly.

**Requirements**:
- Given user is re-quizzing a topic, should filter to only cards answered incorrectly in previous quiz
- Given no incorrect cards exist, should show message that all cards were correct
- Given quiz mode, should track which cards were answered correctly vs incorrectly
- Given user reads topic again and clicks Quiz, should check previous quiz results for that topic

**Files to modify**:
- `src/components/Quiz.tsx`
- `src/components/TopicReader.tsx`

**Key logic**:
- Store quiz results per topic (topicId -> { correct: cardIds[], incorrect: cardIds[] })
- When starting quiz for topic, check if previous quiz exists
- If previous quiz exists, filter to only incorrect cards
- If no incorrect cards, show success message instead of quiz

---

## Task 6: Update Navigation and Routing

Ensure quiz can be started from TopicReader and returns properly with summary view.

**Requirements**:
- Given quiz is active, should show quiz UI instead of topic reading view
- Given quiz completes, should show summary overlay or replace view
- Given user navigates away from quiz, should preserve quiz state if needed
- Given user clicks "Next Topic" from summary, should move to next topic in reading view

**Files to modify**:
- `src/components/TopicReader.tsx`
- Possibly `src/App.tsx` if routing changes needed

---

## Next Steps

1. Start with **Task 1** - Simplest change, replaces UI buttons
2. Then **Task 2** - Create Quiz component (core functionality)
3. Then **Task 4** - Create QuizSummary component (can be built in parallel)
4. Then **Task 3** - Wire everything together
5. Then **Task 5** - Add re-quiz filtering logic
6. Finally **Task 6** - Polish navigation and state management

**Suggested order**: 1 â†’ 2 â†’ 4 â†’ 3 â†’ 5 â†’ 6

